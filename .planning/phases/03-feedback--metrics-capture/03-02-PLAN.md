---
phase: 03-feedback--metrics-capture
plan: 02
type: execute
wave: 2
depends_on: ["03-01", "03-03"]
files_modified:
  - app/session-checkin.tsx
  - components/SessionCheckIn.tsx
  - app/_layout.tsx
  - app/practice/[id].tsx
  - lib/storage.ts
  - types/index.ts
  - __tests__/lib/storage.test.ts
autonomous: true
must_haves:
  truths:
    - "Users complete a post-session survey for focus quality, mood, stress, energy"
    - "Users can enter a lapse count estimate after practice"
    - "Survey data is stored locally and linked to the session"
  artifacts:
    - path: "app/session-checkin.tsx"
      provides: "Post-session survey screen"
    - path: "components/SessionCheckIn.tsx"
      provides: "Survey UI component"
  key_links:
    - from: "app/practice/[id].tsx"
      to: "app/session-checkin.tsx"
      via: "navigation"
      pattern: "SessionCheckIn"
---

<objective>
Implement the post‑session check‑in survey and persist feedback metrics.

Purpose: capture daily focus quality, mood, stress, and energy with a lapse estimate.
Output: new check‑in screen + storage update workflow + navigation changes.
</objective>

<execution_context>
@/Users/richardyu/.claude/get-shit-done/workflows/execute-plan.md
@/Users/richardyu/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-feedback--metrics-capture/03-RESEARCH.md

@app/practice/[id].tsx
@app/_layout.tsx
@types/index.ts
@lib/storage.ts
</context>

<tasks>

<task type="auto">
  <name>Create post-session check-in screen</name>
  <files>components/SessionCheckIn.tsx, app/session-checkin.tsx</files>
  <action>
    - Build a 4-item 1–5 rating UI for focus quality, mood, stress, energy.
    - Add a numeric input for lapse count estimate (prefill with in-session count if provided).
    - Include a primary CTA to save and continue to journaling, and a secondary skip.
  </action>
  <verify>
    - Check-in renders and validates required inputs.
  </verify>
  <done>
    - Survey UI exists and is navigable.
  </done>
</task>

<task type="auto">
  <name>Wire navigation and persistence</name>
  <files>app/_layout.tsx, app/practice/[id].tsx, lib/storage.ts</files>
  <action>
    - Add SessionCheckIn to the stack navigator.
    - After practice completion, navigate to SessionCheckIn with sessionId + practiceType + in-session metrics.
    - Save survey results to the session via storage update helper.
    - Continue to JournalEntry after saving.
  </action>
  <verify>
    - Survey results are saved to the session and available in storage.
  </verify>
  <done>
    - Feedback loop is connected from session → check-in → journal.
  </done>
</task>

</tasks>

<verification>
- Survey data is stored locally and tied to each session.
</verification>

<success_criteria>
- Daily survey + lapse estimate are captured after each practice.
</success_criteria>

<output>
After completion, create `.planning/phases/03-feedback--metrics-capture/03-02-SUMMARY.md`
</output>
